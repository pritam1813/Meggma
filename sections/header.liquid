<header id="site-header" class="w-full fixed border-b border-white z-20">
  <div class="flex items-center px-6 md:px-12 lg:px-14 py-3 sm:py-4 lg:py-6">
    {%- comment -%} Navigation Links (Desktop) / Mobile Menu Button {%- endcomment -%}
    <div id="navlinks" class="flex-1">
      <nav class="hidden lg:block">
        <ul class="flex space-x-6 text-xl flex-wrap">
          {%- for link in section.settings.menu.links -%}
            <li>
              <a href="{{ link.url }}" class="relative py-1 group">
                {{ link.title }}
                <span
                  class="absolute left-0 bottom-0 w-full h-[2px] bg-black scale-x-0 group-hover:scale-x-100 transition-transform duration-300 ease-in-out origin-left"
                ></span>
              </a>
            </li>
          {%- endfor -%}
        </ul>
      </nav>
      <div class="lg:hidden">
        <button id="mobilemenubtn" type="button" aria-label="Open menu">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            aria-hidden="true"
            focusable="false"
            role="presentation"
          >
            <path d="M2 5h20M2 12h16M2 19h12" stroke="currentColor" stroke-width="1.2"
                stroke-linecap="round" stroke-linejoin="round"></path>
          </svg>
        </button>
      </div>
    </div>

    {%- comment -%} Logo {%- endcomment -%}
    <div id="logo">
      <a href="{{ routes.root_url }}">
        {%- if section.settings.logo != blank -%}
          <img
            src="{{ section.settings.logo | image_url: width: section.settings.logo_width | times: 2 }}"
            alt="{{ section.settings.logo.alt | default: shop.name }}"
            width="{{ section.settings.logo_width }}"
            height="auto"
            loading="eager"
          >
        {%- else -%}
          <span class="text-xl font-bold">{{ shop.name }}</span>
        {%- endif -%}
      </a>
    </div>

    {%- comment -%} Utility Icons {%- endcomment -%}
    <div id="utility" class="flex flex-1 justify-end items-center space-x-3">
      {%- comment -%} Localization (Desktop only) {%- endcomment -%}
      {%- if localization.available_countries.size > 1 or localization.available_languages.size > 1 -%}
        <div class="hidden lg:block">
          <button type="button" aria-label="Localization">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <circle cx="12" cy="12" r="10"/>
              <path d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
            </svg>
          </button>
        </div>
      {%- endif -%}

      {%- comment -%} Account (Desktop only) {%- endcomment -%}
      {%- if shop.customer_accounts_enabled -%}
        <a href="{{ routes.account_url }}" class="hidden lg:block" aria-label="Account">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
            <circle cx="12" cy="7" r="4"/>
          </svg>
        </a>
      {%- endif -%}

      {%- comment -%} Search (All screens) {%- endcomment -%}
      <a href="{{ routes.search_url }}" aria-label="Search">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <circle cx="11" cy="11" r="8"/>
          <path d="m21 21-4.35-4.35"/>
        </svg>
      </a>

      {%- comment -%} Cart (All screens) {%- endcomment -%}
      <a href="{{ routes.cart_url }}" class="relative" aria-label="Cart">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/>
          <path d="M3 6h18"/>
          <path d="M16 10a4 4 0 1 1-8 0"/>
        </svg>
        {%- if cart.item_count > 0 -%}
          <span class="absolute -top-1 -right-1 bg-black text-white text-xs rounded-full w-4 h-4 flex items-center justify-center">
            {{ cart.item_count }}
          </span>
        {%- endif -%}
      </a>
    </div>
  </div>
</header>

{%- comment -%} Mobile Overlay {%- endcomment -%}
<div id="mobile-overlay" class="fixed inset-0 bg-black/50 z-40 hidden transition-opacity duration-300"></div>

{%- comment -%} Mobile Drawer {%- endcomment -%}
<div
  id="mobile-drawer"
  class="fixed top-0 left-0 w-[500px] max-w-full h-full bg-white z-50 transform -translate-x-full transition-transform duration-500 ease-in-out shadow-xl"
>
  <div class="px-8">
    <div class="flex justify-between items-center py-6 border-b border-gray-200 border-solid">
      <button id="close-drawer" class="text-2xl" type="button" aria-label="Close menu">&times;</button>
      <div class="flex space-x-3 items-center">
        {%- comment -%} Localization (Mobile - in drawer) {%- endcomment -%}
        {%- if localization.available_countries.size > 1 or localization.available_languages.size > 1 -%}
          <button type="button" aria-label="Localization">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <circle cx="12" cy="12" r="10"/>
              <path d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
            </svg>
          </button>
        {%- endif -%}

        {%- comment -%} Account (Mobile - in drawer) {%- endcomment -%}
        {%- if shop.customer_accounts_enabled -%}
          <a href="{{ routes.account_url }}" aria-label="Account">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
              <circle cx="12" cy="7" r="4"/>
            </svg>
          </a>
        {%- endif -%}
      </div>
    </div>
    <nav class="pt-5">
      <ul class="space-y-3 text-lg">
        {%- for link in section.settings.menu.links -%}
          <li>
            <a href="{{ link.url }}">{{ link.title }}</a>
          </li>
        {%- endfor -%}
      </ul>
    </nav>
  </div>
</div>

{% javascript %}
  const menuBtn = document.getElementById('mobilemenubtn');
  const closeBtn = document.getElementById('close-drawer');
  const drawer = document.getElementById('mobile-drawer');
  const overlay = document.getElementById('mobile-overlay');

  function toggleMenu() {
    drawer.classList.toggle('-translate-x-full');
    overlay.classList.toggle('hidden');
    document.body.classList.toggle('overflow-hidden');
  }

  menuBtn.addEventListener('click', toggleMenu);
  closeBtn.addEventListener('click', toggleMenu);
  overlay.addEventListener('click', toggleMenu);
{% endjavascript %}

{%- comment -%} Section-specific GSAP animations {%- endcomment -%}
<script>
  (function () {
    function initHeroAnimations() {
      const header = document.querySelector('#site-header');

      ScrollTrigger.create({
        start: 'top -10', // triggers as soon as you scroll down 1px
        onEnter: () => {
          gsap.to(header, {
            backgroundColor: '#fff',
            duration: 0.3,
            ease: 'power2.out',
          });
        },
        onLeaveBack: () => {
          gsap.to(header, {
            backgroundColor: 'transparent',
            duration: 0.3,
            ease: 'power2.out',
          });
        },
      });
    }

    // Run when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initHeroAnimations);
    } else {
      initHeroAnimations();
    }
  })();
</script>

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu",
      "default": "main-menu"
    },
    {
      "type": "header",
      "content": "Logo"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo image"
    },
    {
      "type": "range",
      "id": "logo_width",
      "label": "Logo width",
      "min": 50,
      "max": 300,
      "step": 10,
      "default": 130,
      "unit": "px"
    }
  ]
}
{% endschema %}
